<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <title>GOSPORT-PERFIL</title>

    <!-- BOOTSTRAP 5 -->
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" 
        rel="stylesheet">

    <!-- CSS PERSONAL -->
    <link rel="stylesheet" th:href="@{/css/perfil.css}">
    <link rel="icon" type="image/png" href="/img/icono.jpg">
</head>

<body>

    <!-- NAVBAR -->
    <nav class="navbar navbar-expand-lg bg-white shadow-sm py-3">
        <div class="container d-flex align-items-center justify-content-between">

            <a class="navbar-brand d-flex align-items-center" th:href="@{/home}">
                <img th:src="@{/img/icono.jpg}" alt="Logo" class="me-2" style="height: 40px;">
                <span class="fw-bold">GOSPORT</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">

                    <li class="nav-item">
                        <a class="nav-link" th:href="@{/home}">Inicio</a>
                    </li>

                    <li class="nav-item" 
                        th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                        <a class="nav-link" th:href="@{/usuarios}">Usuarios</a>
                    </li>

                     <li class="nav-item" 
                        th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                        <a class="nav-link" th:href="@{/reportes/reservas}">Mis Reservas</a>
                    </li>


                    <li class="nav-item">
                        <form th:action="@{/logout}" method="post">
                            <button class="btn btn-danger ms-3" type="submit">Cerrar Sesión</button>
                        </form>
                    </li>

                </ul>
            </div>

        </div>
    </nav>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="container-perfil py-4">
        <div class="row justify-content-center">
            <div class="col-md-6">

                <!-- Mensaje de éxito -->
                <div th:if="${param.success}" class="alert alert-success text-center mb-3">
                    ¡Perfil actualizado correctamente!
                </div>

                <div class="card shadow-sm p-4">
                    <h2 class="text-center mb-4">Mi Perfil</h2>

                    <!-- Formulario -->
                    <form th:action="@{/mi-perfil/editar}" method="post" enctype="multipart/form-data">
                        <h4>Entonces, parcero, esta cuenta se llama <span th:text="${usuario.username}"></span></h4><br>

                        <!-- Foto de perfil -->
                        <div class="text-center mb-3">
                            <img th:src="@{'/uploads/' + ${usuario.fotoPerfil}}"
                                 alt="Foto de perfil"
                                 width="150"
                                 height="150"
                                 class="rounded-circle mb-2"
                                 onerror="this.src='/img/profile.jpg'">
                                 

                            <input type="file" name="foto" class="form-control mt-2">
                        </div>
                        <br><br>

                        <!-- Nombre de usuario -->
                        <div class="mb-3">
                            <label for="username" class="form-label">Nombre de usuario</label>
                            <input type="text"
                                   id="username"
                                   name="username"
                                   class="form-control"
                                   th:value="${usuario.username}"
                                   required>
                        </div>

                        <!-- Contraseña -->
                        <div class="mb-3">
                            <label for="password" class="form-label">Nueva contraseña</label>
                            <input type="password"
                                   id="password"
                                   name="password"
                                   class="form-control"
                                   placeholder="Dejar vacío si no cambia">
                        </div>

                        <!-- Botón guardar -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg">
                                Actualizar Perfil
                            </button>
                        </div>

                    </form>
                </div>

            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="text-center py-3 mt-4">
        <p>© 2025 GoSports - Sistema de gestión deportiva</p>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
