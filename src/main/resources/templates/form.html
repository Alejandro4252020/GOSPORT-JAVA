<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>crear usuario</title>

    <!-- BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- ICONOS BOOTSTRAP -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background-color: #d7eaff; /* azul claro */
        }
    </style>
</head>
<body>

<!-- NAVBAR NEGRA -->
<nav class="navbar navbar-dark bg-dark">
    <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">GoSport</span>
    </div>
</nav>

<div class="container mt-5">

    <!-- ALERTA DE ÉXITO -->
    <div th:if="${mensajeExito}" class="alert alert-success alert-dismissible fade show" id="alerta-exito">
        <i class="bi bi-check-circle-fill"></i>
        <span th:text="${mensajeExito}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- ALERTA DE ERROR -->
    <div th:if="${mensajeError}" class="alert alert-danger alert-dismissible fade show" id="alerta-error">
        <i class="bi bi-exclamation-triangle-fill"></i>
        <span th:text="${mensajeError}"></span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

   <div class="card shadow-lg p-4 mx-auto"
     style="max-width: 450px; border-radius: 15px; background-color: #807373d5;">


        <h3 class="text-center mb-4"> Crear Usuario</h3>

        <form th:action="${#authorization.expression('hasRole(''ADMIN'')') ? '/usuarios/guardar' : '/perfil/guardar'}"
              th:object="${usuario}" method="post">

            <input type="hidden" th:field="*{id}" />

            <!-- USERNAME -->
            <div class="mb-3">
                <label class="form-label">Nombre de usuario:</label>
                <input type="text" th:field="*{userName}" class="form-control" placeholder="Ingrese el usuario" required>
            </div>

            <!-- PASSWORD -->
            <div class="mb-3">
                <label class="form-label">Contraseña:</label>

                <div class="input-group">
                    <input type="password" th:field="*{password}" id="password" class="form-control" placeholder="Ingrese la contraseña" required>

                    <button class="btn btn-outline-secondary" type="button" id="togglePass">
                        <i class="bi bi-eye-slash" id="iconEye"></i>
                    </button>
                </div>
            </div>

            <!-- ROL SOLO PARA ADMIN -->
            <div class="mb-3" th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
                <label class="form-label">Rol:</label>
                <select th:field="*{rol}" class="form-select">
                    <option value="ADMIN">ADMIN</option>
                    <option value="USER">USER</option>
                </select>
            </div>

            <button type="submit" class="btn btn-primary w-100 mt-3">Guardar</button>

        </form>

    </div>
</div>

<!-- BOOTSTRAP JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- SCRIPT MOSTRAR/OCULTAR CONTRASEÑA -->
<script>
document.getElementById("togglePass").addEventListener("click", function () {
    const pass = document.getElementById("password");
    const icon = document.getElementById("iconEye");

    if (pass.type === "password") {
        pass.type = "text";
        icon.classList.replace("bi-eye-slash", "bi-eye");
    } else {
        pass.type = "password";
        icon.classList.replace("bi-eye", "bi-eye-slash");
    }
});

// Ocultar alertas después de 4 segundos
setTimeout(() => {
    const alerta = document.getElementById("alerta-exito");
    if (alerta) alerta.style.display = "none";

    const alertaE = document.getElementById("alerta-error");
    if (alertaE) alertaE.style.display = "none";
}, 4000);
</script>

</body>
</html>
